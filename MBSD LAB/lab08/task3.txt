#include <msp430.h>

int main(void)
{
    WDTCTL = WDTPW | WDTHOLD;
    PM5CTL0 &= ~LOCKLPM5;
    P1DIR |= BIT0;
    P1OUT &= ~BIT0;
    P1DIR &= ~BIT2;  
    P1REN |=  BIT2; 
    P1OUT |=  BIT2; 
    P1IES |=  BIT2; 
    P1IFG &= ~BIT2; 
    P1IE  |=  BIT2;
    if (SYSRSTIV == SYSRSTIV_LPM5WU)
    {
        while (1)
        {
            P1OUT ^= BIT0;             
            __delay_cycles(100000);  
        }
    }

    // 5) Otherwise, enter LPM4.5
    PMMCTL0_H = PMMPW_H;    
    PMMCTL0_L |= PMMREGOFF;   
    __bis_SR_register(LPM4_bits | GIE);

    while (1); // Should never reach here
}

// Port 1 ISR
#pragma vector=PORT1_VECTOR
__interrupt void Port1_ISR(void)
{
    P1IFG &= ~BIT2;  // Clear interrupt flag
}
